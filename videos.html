<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YouTube Channel Portfolio</title>
  <!-- Google Font (Oswald) -->
  <link
    href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <style>
    /* -----------------------------------------------
       Basic Reset & Root Variables
       ----------------------------------------------- */
    :root {
      --font-sans: 'Oswald', sans-serif;
      --accent-color: #e4ac45;
      --bg-page: #f5f5f5;
      --card-bg: #ffffff;
      --card-border-radius: 0.5rem;
      --text-dark: #333333;
      --text-light: #666666;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html {
      scroll-behavior: smooth;
    }
    body {
      background: var(--bg-page);
      font-family: var(--font-sans);
      color: var(--text-dark);
      line-height: 1.5;
      padding: 2rem;
    }
    a {
      color: var(--accent-color);
      text-decoration: none;
    }

    /* -----------------------------------------------
       Heading & Subheading
       ----------------------------------------------- */
    .page-title {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      color: var(--text-dark);
    }
    .page-subtitle {
      text-align: center;
      color: var(--text-light);
      margin-bottom: 2rem;
      font-size: 1.1rem;
    }

    /* -----------------------------------------------
       Video Grid Container
       ----------------------------------------------- */
    #video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    /* -----------------------------------------------
       Individual Video Card
       ----------------------------------------------- */
    .video-card {
      background: var(--card-bg);
      border-radius: var(--card-border-radius);
      box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: transform 0.2s ease;
    }
    .video-card:hover {
      transform: translateY(-4px);
    }

    .video-card img {
      width: 100%;
      height: auto;
      display: block;
      object-fit: cover;
    }

    .video-info {
      padding: 1rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .video-title {
      font-size: 1.1rem;
      font-weight: bold;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
    }
    .video-views {
      font-size: 0.9rem;
      color: var(--text-light);
    }

    /* -----------------------------------------------
       Loading Spinner (optional)
       ----------------------------------------------- */
    #loading {
      text-align: center;
      margin-top: 2rem;
      font-size: 1.2rem;
      color: var(--text-light);
    }
  </style>
</head>
<body>
  <h1 class="page-title">Portfolio &amp; Metrics</h1>
  <p class="page-subtitle">
    Displaying all videos from the channel • White card style<br />
    (Replace this subtitle with your own metrics…)
  </p>

  <!-- This is where all video‐cards will be inserted -->
  <div id="video-grid"></div>
  <p id="loading">Loading videos… please wait.</p>

  <script>
    // ────────────────────────────────
    //  1) CONFIGURATION
    // ────────────────────────────────
    const API_KEY = 'AIzaSyDjwfqf775NaJ0vJyN7eRbp69EFzcNI6WAE';        // ← Replace with your YouTube Data API v3 key
    const CHANNEL_ID = 'UC3QjBcBCtS4I-OWKpTBBFWA';  // ← Replace with the target channel’s ID

    // ────────────────────────────────
    //  2) UTILITY: Human‐Readable Number Formatter
    // ────────────────────────────────
    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // ────────────────────────────────
    //  3) FETCH “Uploads” Playlist ID
    //     (Every channel has an “uploads” playlist)
    // ────────────────────────────────
    async function fetchUploadsPlaylistId() {
      const endpoint = `https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${CHANNEL_ID}&key=${API_KEY}`;
      const res = await fetch(endpoint);
      const data = await res.json();
      if (data.items && data.items.length > 0) {
        return data.items[0].contentDetails.relatedPlaylists.uploads;
      } else {
        throw new Error('Channel not found or no contentDetails available.');
      }
    }

    // ────────────────────────────────
    //  4) FETCH ALL VIDEO IDs from that Playlist
    //     (Paging through “playlistItems” in blocks of 50)
    // ────────────────────────────────
    async function fetchAllVideoIds(playlistId) {
      let videoIds = [];
      let nextPageToken = '';
      do {
        const url = new URL('https://www.googleapis.com/youtube/v3/playlistItems');
        url.search = new URLSearchParams({
          part: 'contentDetails',
          maxResults: '50',
          playlistId: playlistId,
          pageToken: nextPageToken,
          key: API_KEY
        });
        const resp = await fetch(url);
        const json = await resp.json();
        if (json.items) {
          json.items.forEach(item => {
            videoIds.push(item.contentDetails.videoId);
          });
        }
        nextPageToken = json.nextPageToken || '';
      } while (nextPageToken);
      return videoIds;
    }

    // ────────────────────────────────
    //  5) FETCH METADATA (snippet + statistics) for all video IDs
    //     We’ll batch up to 50 IDs per “videos” request
    // ────────────────────────────────
    async function fetchVideoDetails(allIds) {
      const BATCH_SIZE = 50;
      let details = [];

      for (let i = 0; i < allIds.length; i += BATCH_SIZE) {
        const batchIds = allIds.slice(i, i + BATCH_SIZE).join(',');
        const url = new URL('https://www.googleapis.com/youtube/v3/videos');
        url.search = new URLSearchParams({
          part: 'snippet,statistics',
          id: batchIds,
          key: API_KEY
        });
        const resp = await fetch(url);
        const json = await resp.json();
        if (json.items) {
          details.push(...json.items);
        }
      }

      return details;
    }

    // ────────────────────────────────
    //  6) RENDER CARDS INTO THE DOM
    // ────────────────────────────────
    function renderVideoCards(videoItems) {
      const grid = document.getElementById('video-grid');
      // Clear loading text:
      document.getElementById('loading').style.display = 'none';

      videoItems.forEach(item => {
        const thumbUrl = item.snippet.thumbnails.high.url;
        const title = item.snippet.title;
        const views = item.statistics.viewCount || 0;
        const videoId = item.id;
        const watchLink = `https://www.youtube.com/watch?v=${videoId}`;

        // Create the card element
        const card = document.createElement('div');
        card.classList.add('video-card');

        // Thumbnail (clickable)
        const thumbAnchor = document.createElement('a');
        thumbAnchor.href = watchLink;
        thumbAnchor.target = '_blank';
        thumbAnchor.rel = 'noopener';

        const thumbImg = document.createElement('img');
        thumbImg.src = thumbUrl;
        thumbImg.alt = title;
        thumbAnchor.appendChild(thumbImg);

        // Info container
        const info = document.createElement('div');
        info.classList.add('video-info');

        const titleEl = document.createElement('h3');
        titleEl.classList.add('video-title');
        titleEl.textContent = title;
        info.appendChild(titleEl);

        const viewsEl = document.createElement('p');
        viewsEl.classList.add('video-views');
        viewsEl.textContent = formatNumber(views) + ' views';
        info.appendChild(viewsEl);

        // Assemble card
        card.appendChild(thumbAnchor);
        card.appendChild(info);

        // Append to grid
        grid.appendChild(card);
      });
    }

    // ────────────────────────────────
    //  7) MAIN: Orchestrate All Calls
    // ────────────────────────────────
    async function init() {
      try {
        // 1) Get the “uploads” playlist ID
        const uploadsPlaylistId = await fetchUploadsPlaylistId();

        // 2) Get every video ID in that playlist
        const allVideoIds = await fetchAllVideoIds(uploadsPlaylistId);

        if (allVideoIds.length === 0) {
          document.getElementById('loading').textContent = 'No videos found on this channel.';
          return;
        }

        // 3) Fetch details (snippet + statistics) for all videos
        const videoDetails = await fetchVideoDetails(allVideoIds);

        // 4) Render them in white‐background cards
        renderVideoCards(videoDetails);
      } catch (err) {
        console.error(err);
        document.getElementById('loading').textContent = 'An error occurred. See console for details.';
      }
    }

    // Kick off the process
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
