<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Tab title -->
  <title>YouTube Portfolio | ADMINISTRATIVE RESULTS</title>

  <!-- Favicon -->
  <link
    rel="icon"
    href="assets/images/favicon.png"
    type="image/png"
  />

  <!-- Social Sharing Tags (same as index) -->
  <meta property="og:title" content="Home of the AR64A" />
  <meta property="og:description" content="The AR64A H-Harness Patrol Rig—private-merc vibes, built for operators." />
  <meta property="og:image" content="https://administrativeresults.github.io/assets/images/preview.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:url" content="https://administrativeresults.github.io/" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Home of the AR64A" />
  <meta name="twitter:description" content="The AR64A H-Harness Patrol Rig—private-merc vibes, built for operators." />
  <meta name="twitter:image" content="https://administrativeresults.github.io/assets/images/preview.jpg" />

  <!-- Google Font (Oswald) -->
  <link
    href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <!-- Font Awesome (optional) -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-pTg6vAPDFCA+WB9Sgy0/sGxEk/ckG6VXihYE+LfR6N6+qSShiBTikpLgEFH3ylLAOIQ+9oNkP+Unx5p+X0COlw=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <style>
    /* ==================================================
       Reset & Root Variables
       ================================================== */
    :root {
      --font-sans: 'Oswald', sans-serif;
      --accent-color: #e4ac45;
      --bg-page: #f5f5f5;
      --card-bg: #ffffff;
      --card-border-radius: 0.5rem;
      --text-dark: #333333;
      --text-light: #666666;

      /* Header/Footer background (dark grey) */
      --header-footer-bg: #111111;
      --header-footer-text: #eeeeee;
    }
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html {
      scroll-behavior: smooth;
    }
    body {
      background: var(--bg-page);
      color: var(--text-dark);
      font-family: var(--font-sans);
      line-height: 1.5;

      /* Only top padding remains for the fixed header */
      padding-top: 4.5rem;
      padding-bottom: 0;
    }
    a {
      color: var(--accent-color);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }

    /* ==================================================
       Header
       ================================================== */
    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: var(--header-footer-bg);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      z-index: 100;
    }
    header .logo-link {
      display: flex;
      align-items: center;
    }
    header .logo-link img {
      height: 40px;
      width: auto;
      margin-right: 0.5rem;
    }
    header .logo-text {
      font-size: 1.25rem;
      font-weight: bold;
      color: var(--header-footer-text);
      line-height: 1;
    }
    header .logo-link,
    header .logo-link:hover,
    header .logo-link:focus {
      text-decoration: none;
    }

    /* Hamburger toggle */
    .menu-toggle {
      display: none;
      font-size: 1.5rem;
      color: var(--header-footer-text);
      background: none;
      border: none;
      cursor: pointer;
    }

    header nav {
      display: flex;
      gap: 1.5rem;
    }
    header nav a {
      font-weight: 500;
      color: var(--header-footer-text);
    }

    /* ==================================================
       Hero Section (Title + Subtitle)
       ================================================== */
    .page-hero {
      text-align: center;
      margin-bottom: 2rem;
      padding: 0 1rem;
    }
    .page-title {
      font-size: 2.5rem;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
    }
    .page-subtitle {
      font-size: 1.1rem;
      color: var(--text-light);
    }

    /* ==================================================
       Video Grid Container (30 cards per page)
       ================================================== */
    #video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Each Video Card (16×9 cropping, no black bars) */
    .video-card {
      background: var(--card-bg);
      border-radius: var(--card-border-radius);
      box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: transform 0.2s ease;
    }
    .video-card:hover {
      transform: translateY(-4px);
    }
    /* Container to enforce 16:9 aspect ratio */
    .video-thumb-container {
      position: relative;
      width: 100%;
      /* 16:9 aspect ratio */
      padding-top: 56.25%;
      overflow: hidden;
      background: #000;
    }
    .video-thumb-container img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center center;
    }

    .video-info {
      padding: 1rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .video-title {
      font-size: 1.1rem;
      font-weight: bold;
      color: var(--text-dark);
      margin-bottom: 0.5rem;
    }
    .video-views {
      font-size: 0.9rem;
      color: var(--text-light);
    }

    /* ==================================================
       Loading Text
       ================================================== */
    #loading {
      text-align: center;
      margin-top: 2rem;
      font-size: 1.2rem;
      color: var(--text-light);
    }

    /* ==================================================
       Pagination Controls
       ================================================== */
    #pagination {
      margin: 2rem auto;
      margin-bottom: 4rem;
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      font-size: 1rem;
    }
    #pagination button {
      background: var(--accent-color);
      color: #000;
      border: none;
      border-radius: 4px;
      padding: 0.5rem 1rem;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.2s ease;
    }
    #pagination button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    #pagination button:hover:not(:disabled) {
      background: #d39f38;
    }
    #pagination .page-indicator {
      color: var(--text-dark);
    }

    /* ==================================================
       Footer (static, appears only at page bottom)
       ================================================== */
    footer {
      background: var(--header-footer-bg);
      color: var(--header-footer-text);
      padding: 1.5rem 2rem;
      text-align: center;
    }
    footer .footer-logo {
      display: inline-block;
      margin-bottom: 0.75rem;
      cursor: pointer;
    }
    footer .footer-logo img {
      height: 40px;
      width: auto;
    }
    footer nav a {
      color: var(--header-footer-text);
      margin: 0 0.75rem;
      font-weight: 500;
    }
    footer p {
      margin-top: 0.75rem;
      font-size: 0.9rem;
    }

    /* ==================================================
       Responsive: collapse header nav on small screens
       ================================================== */
    @media (max-width: 768px) {
      .menu-toggle {
        display: block;
      }
      header nav {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background: var(--header-footer-bg);
        width: 100%;
        flex-direction: column;
        gap: 0;
      }
      header nav a {
        padding: 1rem 2rem;
        border-bottom: 1px solid #222;
        margin: 0;
      }
      header nav.active {
        display: flex;
      }
    }
  </style>
</head>
<body>

  <!-- ===============================
       Header (with hamburger on mobile)
       =============================== -->
  <header>
    <a href="index.html" class="logo-link">
      <img src="assets/images/logo.png" alt="Administrative Results Logo" />
      <span class="logo-text">ADMINISTRATIVE RESULTS</span>
    </a>

    <!-- Hamburger toggle button -->
    <button class="menu-toggle" onclick="toggleMenu()">☰</button>

    <nav id="headerNav">
      <a href="index.html">Home</a>
      <a href="videos.html">Videos</a>
      <a href="service.html">Customer Service</a>
    </nav>
  </header>

  <!-- ===============================
       Hero Title & Subtitle (no video, per request)
       =============================== -->
  <div class="page-hero">
    <h1 class="page-title">Please watch...</h1>
    <p class="page-subtitle">
      At Administrative Results we strive to educate where we can, and entertain all the time. <br />
      We are passionate about the 2nd Amendment and the way of life it is meant to preserve.
    </p>
  </div>

  <!-- =========================================================
       Video Grid (cards will be dynamically inserted here)
       ========================================================= -->
  <div id="video-grid"></div>
  <p id="loading">Loading videos… please wait.</p>

  <!-- =========================================================
       Pagination Controls (Prev / Next / Page #)
       ========================================================= -->
  <div id="pagination">
    <button id="prevBtn" disabled>Previous</button>
    <span class="page-indicator">
      Page <span id="currentPage">1</span> of <span id="totalPages">1</span>
    </span>
    <button id="nextBtn" disabled>Next</button>
  </div>

  <!-- ===============================
       Footer (static, appears only at bottom of content)
       =============================== -->
  <footer>
    <div class="footer-logo">
      <a href="#hero">
        <img src="assets/images/logo.png" alt="Back to top" />
      </a>
    </div>
    <nav>
      <a href="index.html">Home</a> |
      <a href="videos.html">Videos</a> |
      <a href="service.html">Customer Service</a>
    </nav>
    <p>&copy; 2025 Administrative Results. All Rights Reserved.</p>
  </footer>

  <!-- ===============================
       Script: Fetch + Render + Pagination + Toggle Menu
       =============================== -->
  <script>
    // Toggle mobile menu
    function toggleMenu() {
      document.getElementById('headerNav').classList.toggle('active');
    }

    // ─────────────────────────────────────────────
    //  1) CONFIGURATION
    // ─────────────────────────────────────────────
    const API_KEY    = 'AIzaSyDjwfqf775NaJ0vJyN7eRbp69EFzcNI6WA';        // ← Your YouTube Data API v3 key
    const CHANNEL_ID = 'UC3QjBcBCtS4I-OWKpTBBFWA';                       // ← The target channel’s ID
    const PAGE_SIZE  = 30;                                               // videos per page

    // ─────────────────────────────────────────────
    //  2) UTILITY: Human-Readable Number Formatter
    // ─────────────────────────────────────────────
    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // ─────────────────────────────────────────────
    //  3) FETCH “Uploads” Playlist ID
    // ─────────────────────────────────────────────
    async function fetchUploadsPlaylistId() {
      const endpoint = `https://www.googleapis.com/youtube/v3/channels`
        + `?part=contentDetails&id=${CHANNEL_ID}&key=${API_KEY}`;
      const res = await fetch(endpoint);
      const data = await res.json();
      if (data.items && data.items.length > 0) {
        return data.items[0].contentDetails.relatedPlaylists.uploads;
      } else {
        throw new Error('Channel not found or no contentDetails available.');
      }
    }

    // ─────────────────────────────────────────────
    //  4) FETCH ALL VIDEO IDs from that Playlist
    // ─────────────────────────────────────────────
    async function fetchAllVideoIds(playlistId) {
      let videoIds = [];
      let nextPageToken = '';
      do {
        const url = new URL('https://www.googleapis.com/youtube/v3/playlistItems');
        url.search = new URLSearchParams({
          part: 'contentDetails',
          maxResults: '50',
          playlistId: playlistId,
          pageToken: nextPageToken,
          key: API_KEY
        });
        const resp = await fetch(url);
        const json = await resp.json();
        if (json.items) {
          json.items.forEach(item => {
            videoIds.push(item.contentDetails.videoId);
          });
        }
        nextPageToken = json.nextPageToken || '';
      } while (nextPageToken);
      return videoIds;
    }

    // ─────────────────────────────────────────────
    //  5) FETCH METADATA (snippet + statistics + contentDetails)
    // ─────────────────────────────────────────────
    async function fetchVideoDetails(allIds) {
      const BATCH_SIZE = 50;
      let details = [];

      for (let i = 0; i < allIds.length; i += BATCH_SIZE) {
        const batchIds = allIds.slice(i, i + BATCH_SIZE).join(',');
        const url = new URL('https://www.googleapis.com/youtube/v3/videos');
        url.search = new URLSearchParams({
          part: 'snippet,statistics,contentDetails',
          id: batchIds,
          key: API_KEY
        });
        const resp = await fetch(url);
        const json = await resp.json();
        if (json.items) {
          details.push(...json.items);
        }
      }
      return details;
    }

    // ─────────────────────────────────────────────
    //  6) FILTER OUT “Shorts” (videos < 60s) & SORT LATEST FIRST
    // ─────────────────────────────────────────────
    function filterLongFormVideos(videoItems) {
      return videoItems
        .filter(item => {
          // contentDetails.duration is ISO 8601, e.g. "PT5M20S", "PT45S", "PT1H2M3S"
          const dur = item.contentDetails.duration;
          // If it matches exactly “PT<number>S” → less than 60s → skip
          // Otherwise keep (so PT1MxxS, PT2M, PT1H… are long-form)
          return !/^PT\d+S$/.test(dur);
        })
        // Sort by publish date (newest first)
        .sort((a, b) => {
          const dateA = new Date(a.snippet.publishedAt).getTime();
          const dateB = new Date(b.snippet.publishedAt).getTime();
          return dateB - dateA;
        });
    }

    // ─────────────────────────────────────────────
    //  7) RENDER A SINGLE PAGE OF CARDS
    // ─────────────────────────────────────────────
    function renderVideoCardsPage(videoItems, pageNum, pageSize) {
      const grid = document.getElementById('video-grid');
      grid.innerHTML = ''; // clear existing

      const startIdx = (pageNum - 1) * pageSize;
      const endIdx   = Math.min(startIdx + pageSize, videoItems.length);
      const pageItems = videoItems.slice(startIdx, endIdx);

      pageItems.forEach(item => {
        const thumbUrl = item.snippet.thumbnails.high.url;
        const title    = item.snippet.title;
        const views    = item.statistics.viewCount || 0;
        const videoId  = item.id;
        const watchLink = `https://www.youtube.com/watch?v=${videoId}`;

        // <div class="video-card">
        const card = document.createElement('div');
        card.classList.add('video-card');

        // 16×9 thumbnail container
        const thumbContainer = document.createElement('div');
        thumbContainer.classList.add('video-thumb-container');

        const thumbImg = document.createElement('img');
        thumbImg.src = thumbUrl;
        thumbImg.alt = title;
        // Wrap in <a>
        const thumbAnchor = document.createElement('a');
        thumbAnchor.href = watchLink;
        thumbAnchor.target = '_blank';
        thumbAnchor.rel = 'noopener';
        thumbAnchor.appendChild(thumbImg);

        thumbContainer.appendChild(thumbAnchor);
        card.appendChild(thumbContainer);

        // Info container
        const info = document.createElement('div');
        info.classList.add('video-info');

        const titleEl = document.createElement('h3');
        titleEl.classList.add('video-title');
        titleEl.textContent = title;
        info.appendChild(titleEl);

        const viewsEl = document.createElement('p');
        viewsEl.classList.add('video-views');
        viewsEl.textContent = formatNumber(views) + ' views';
        info.appendChild(viewsEl);

        card.appendChild(info);
        grid.appendChild(card);
      });
    }

    // ─────────────────────────────────────────────
    //  8) PAGINATION CONTROLS LOGIC
    // ─────────────────────────────────────────────
    let allFilteredVideos = []; // will hold filtered & sorted videos
    let currentPage = 1;
    let totalPages = 1;

    function updatePaginationControls() {
      document.getElementById('currentPage').textContent = currentPage;
      document.getElementById('totalPages').textContent  = totalPages;

      document.getElementById('prevBtn').disabled = (currentPage <= 1);
      document.getElementById('nextBtn').disabled = (currentPage >= totalPages);
    }

    function showPage(pageNum) {
      currentPage = pageNum;
      renderVideoCardsPage(allFilteredVideos, currentPage, PAGE_SIZE);
      updatePaginationControls();
      // Scroll up so user sees new cards
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.getElementById('prevBtn').addEventListener('click', () => {
      if (currentPage > 1) showPage(currentPage - 1);
    });
    document.getElementById('nextBtn').addEventListener('click', () => {
      if (currentPage < totalPages) showPage(currentPage + 1);
    });

    // ─────────────────────────────────────────────
    //  9) MAIN: Orchestrate All Calls + Initialize
    // ─────────────────────────────────────────────
    async function init() {
      try {
        // 1) Get uploads playlist
        const uploadsPlaylistId = await fetchUploadsPlaylistId();

        // 2) Get all video IDs from that playlist
        const allVideoIds = await fetchAllVideoIds(uploadsPlaylistId);

        if (!allVideoIds.length) {
          document.getElementById('loading').textContent = 'No videos found on this channel.';
          return;
        }

        // 3) Fetch details for all videos (snippet + statistics + contentDetails)
        const videoDetails = await fetchVideoDetails(allVideoIds);

        // 4) Filter out "shorts" (< 60s) and sort by newest first
        allFilteredVideos = filterLongFormVideos(videoDetails);

        if (!allFilteredVideos.length) {
          document.getElementById('loading').textContent = 'No long-form videos found.';
          return;
        }

        // 5) Calculate pagination
        totalPages = Math.ceil(allFilteredVideos.length / PAGE_SIZE);

        // 6) Hide loading text & show first page
        document.getElementById('loading').style.display = 'none';
        showPage(1);
      }
      catch (err) {
        console.error(err);
        document.getElementById('loading').textContent = 'An error occurred. Check console for details.';
      }
    }

    // Kick off once DOM is ready
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
